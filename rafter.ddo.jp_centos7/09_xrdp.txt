<<<<<<< HEAD
rafter.ddo.jp CentOS release 7.0 (Oracle VirtualBox)

xrdp

1. EPEL 確認

   # rpm -qa | grep epel
   epel-release-7-5.noarch

2. /etc/yum.repos.d/xrdp.repo 作成

   # cat /etc/yum.repos.d/xrdp.repo
   [xrdp]
   name=xrdp
   baseurl=http://li.nux.ro/download/nux/dextop/el7/x86_64/
   enabled=1
   gpgcheck=0

3. インストール、起動

   # yum -y install xrdp tigervnc-server

   # systemctl start xrdp.service
   # systemctl enable xrdp.service

4. /etc/sysconfig/iptables 変更内容

   # cat /etc/sysconfig/iptables
   # Generated by iptables-save v1.4.21 on Wed Nov 26 21:47:14 2014
   *nat
   :PREROUTING ACCEPT [0:0]
   :INPUT ACCEPT [0:0]
   :OUTPUT ACCEPT [0:0]
   :POSTROUTING ACCEPT [0:0]
   -A POSTROUTING -s 192.168.56.0/24 -o enp0s3 -j SNAT --to-source 192.168.1.108
   -A PREROUTING -s 192.168.56.0/24 -i enp0s8 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080
   COMMIT
   # Completed on Wed Nov 26 21:47:14 2014
   # Generated by iptables-save v1.4.21 on Wed Nov 26 21:47:14 2014
   *filter
   :INPUT DROP [0:0]
   :FORWARD ACCEPT [145:9740]
   :OUTPUT ACCEPT [6590:4340814]
   :LOGGING - [0:0]
   -A INPUT -i lo -j ACCEPT
   -A INPUT -i enp0s8 -j ACCEPT
   -A INPUT -i enp0s3 -p icmp -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 21 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 22 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 53 -j ACCEPT
   -A INPUT -i enp0s3 -p udp -m udp --dport 53 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 3389 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 5900 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 25,465,587 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 80,443 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 110,995 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 143,993 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 8080 -j ACCEPT
   -A INPUT -i enp0s3 -m state --state RELATED,ESTABLISHED -j ACCEPT
   -A INPUT -i enp0s3 -j LOGGING
   -A OUTPUT -d 218.216.185.65/32 -o enp0s3 -p tcp -m tcp --dport 80 -j DROP
   -A LOGGING -i enp0s3 -m limit --limit 3/hour -j LOG --log-prefix "[iptables DROP]:" --log-level 7
   -A LOGGING -i enp0s3 -j DROP
   COMMIT
   # Completed on Wed Nov 26 21:47:14 2014
=======
rafter.ddo.jp CentOS release 7.0 (Oracle VirtualBox)

xrdp

1. EPEL 確認

   # rpm -qa | grep epel
   epel-release-7-5.noarch

2. /etc/yum.repos.d/xrdp.repo 作成

   # cat /etc/yum.repos.d/xrdp.repo
   [xrdp]
   name=xrdp
   baseurl=http://li.nux.ro/download/nux/dextop/el7/x86_64/
   enabled=1
   gpgcheck=0

3. インストール、起動

   # yum -y install xrdp tigervnc-server

   # systemctl start xrdp.service
   # systemctl enable xrdp.service

4. /etc/sysconfig/iptables 変更内容

   # cat /etc/sysconfig/iptables
   # Generated by iptables-save v1.4.21 on Wed Nov 26 21:47:14 2014
   *nat
   :PREROUTING ACCEPT [0:0]
   :INPUT ACCEPT [0:0]
   :OUTPUT ACCEPT [0:0]
   :POSTROUTING ACCEPT [0:0]
   -A POSTROUTING -s 192.168.56.0/24 -o enp0s3 -j SNAT --to-source 192.168.1.108
   -A PREROUTING -s 192.168.56.0/24 -i enp0s8 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080
   COMMIT
   # Completed on Wed Nov 26 21:47:14 2014
   # Generated by iptables-save v1.4.21 on Wed Nov 26 21:47:14 2014
   *filter
   :INPUT DROP [0:0]
   :FORWARD ACCEPT [145:9740]
   :OUTPUT ACCEPT [6590:4340814]
   :LOGGING - [0:0]
   -A INPUT -i lo -j ACCEPT
   -A INPUT -i enp0s8 -j ACCEPT
   -A INPUT -i enp0s3 -p icmp -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 21 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 22 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 53 -j ACCEPT
   -A INPUT -i enp0s3 -p udp -m udp --dport 53 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 3389 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m tcp --dport 5900 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 25,465,587 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 80,443 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 110,995 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 143,993 -j ACCEPT
   -A INPUT -i enp0s3 -p tcp -m multiport --dports 8080 -j ACCEPT
   -A INPUT -i enp0s3 -m state --state RELATED,ESTABLISHED -j ACCEPT
   -A INPUT -i enp0s3 -j LOGGING
   -A OUTPUT -d 218.216.185.65/32 -o enp0s3 -p tcp -m tcp --dport 80 -j DROP
   -A LOGGING -i enp0s3 -m limit --limit 3/hour -j LOG --log-prefix "[iptables DROP]:" --log-level 7
   -A LOGGING -i enp0s3 -j DROP
   COMMIT
   # Completed on Wed Nov 26 21:47:14 2014
>>>>>>> e6bea64517a0ae1f48fb3b493944504343180536
